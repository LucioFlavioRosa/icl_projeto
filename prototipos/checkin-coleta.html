<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Check-in de Coleta | Gestão de Fretes</title>
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/themes/hello-elementor/style.css?ver=6.8.3">
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/themes/icl/css/general.min.css?ver=1761724536">
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/themes/icl/css/new-styles.min.css?ver=1761724536">
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/plugins/elementor/assets/lib/font-awesome/css/all.min.css?ver=3.32.5">
  <style>
    body { background: #f7fafd; font-family: 'Inter', 'Demo', Arial, sans-serif; }
    .container-main { max-width: 420px; margin: 60px auto 0 auto; background: #fff; border-radius: 18px; box-shadow: 0 8px 32px rgba(0,0,0,0.09); padding: 36px 28px 32px 28px; }
    .titulo { font-size: 2rem; color: #00B5D3; font-weight: 400; margin-bottom: 10px; }
    .subtitulo { color: #002846; font-size: 1.1rem; margin-bottom: 32px; }
    .input-token { width: 100%; font-size: 2.1rem; letter-spacing: 0.12em; padding: 18px 14px; border-radius: 12px; border: 2px solid #00B5D3; background: #f9f9fc; text-align: center; margin-bottom: 16px; font-family: 'Inter', 'Demo', Arial, sans-serif; }
    .btn-validar { width: 100%; background: #00B5D3; color: #fff; border: none; border-radius: 100px; padding: 14px 0; font-size: 1.1rem; font-weight: 500; cursor: pointer; margin-bottom: 10px; transition: background 0.2s; }
    .btn-validar:hover { background: #009bb8; }
    .feedback { text-align: center; font-size: 1.1rem; margin-top: 8px; }
    .feedback.sucesso { color: #00B5D3; }
    .feedback.erro { color: #cf2e2e; }
    .agendamento-info { background: #f0f7fa; border-radius: 10px; padding: 18px 16px; margin-top: 28px; }
    .agendamento-info dt { color: #00B5D3; font-weight: 500; font-size: 1rem; }
    .agendamento-info dd { margin: 0 0 10px 0; color: #002846; font-size: 1rem; }
    @media (max-width: 600px) {
      .container-main { padding: 16px 4vw; }
      .titulo { font-size: 1.3rem; }
      .input-token { font-size: 1.3rem; }
    }
  </style>
</head>
<body>
  <main class="container-main" aria-label="Check-in de Coleta">
    <h1 class="titulo">Check-in de Chegada</h1>
    <p class="subtitulo">Informe o token recebido para registrar o horário de chegada do veículo.</p>
    <form id="formCheckin" autocomplete="off" novalidate>
      <input type="text" id="token" class="input-token" maxlength="12" placeholder="TOKEN DE CHECK-IN" aria-label="Token de Check-in" required autofocus>
      <button type="submit" class="btn-validar">Validar Token</button>
      <div id="feedback" class="feedback" aria-live="polite"></div>
    </form>
    <section id="infoAgendamento" style="display:none;">
      <dl class="agendamento-info">
        <dt>Agendamento:</dt>
        <dd>#123456 - Fornecedor XPTO</dd>
        <dt>Horário Agendado:</dt>
        <dd>12/07/2024, 10:00</dd>
        <dt>Horário Real de Chegada:</dt>
        <dd id="horaReal"></dd>
        <dt>Diferença:</dt>
        <dd id="diferenca"></dd>
      </dl>
    </section>
  </main>
  <script>
    function validarToken(token) {
      // Simulação: token válido = "ICL2024"
      return token.trim().toUpperCase() === 'ICL2024';
    }
    function formatarHora(dt) {
      return dt.toLocaleString('pt-BR', { hour: '2-digit', minute: '2-digit', day: '2-digit', month: '2-digit', year: 'numeric' });
    }
    document.getElementById('formCheckin').addEventListener('submit', function(e) {
      e.preventDefault();
      const token = document.getElementById('token').value;
      const feedback = document.getElementById('feedback');
      feedback.textContent = '';
      document.getElementById('infoAgendamento').style.display = 'none';
      if (!token) {
        feedback.textContent = 'Informe o token.';
        feedback.className = 'feedback erro';
        return;
      }
      if (validarToken(token)) {
        feedback.textContent = 'Check-in realizado com sucesso!';
        feedback.className = 'feedback sucesso';
        // Exibe informações do agendamento
        document.getElementById('infoAgendamento').style.display = 'block';
        const agora = new Date();
        document.getElementById('horaReal').textContent = formatarHora(agora);
        // Horário agendado (simulado)
        const agendado = new Date(2024, 6, 12, 10, 0, 0); // 12/07/2024 10:00
        let diffMin = Math.round((agora - agendado) / 60000);
        let diffStr = '';
        if (diffMin === 0) diffStr = 'No horário';
        else if (diffMin > 0) diffStr = '+' + diffMin + ' min (atraso)';
        else diffStr = diffMin + ' min (adiantado)';
        document.getElementById('diferenca').textContent = diffStr;
        setTimeout(function(){ window.location.href = 'anexo-documentos.html'; }, 2000);
      } else {
        feedback.textContent = 'Token inválido. Verifique e tente novamente.';
        feedback.className = 'feedback erro';
      }
    });
  </script>
</body>
</html>