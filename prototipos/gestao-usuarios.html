<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gest칚o de Usu치rios - ICL Gest칚o de Fretes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/png" href="https://bra.icl-group.com/wp-content/uploads/2020/12/Asset-10.png"/>
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/themes/hello-elementor/assets/css/theme.css?ver=1761639274" media="all" />
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/themes/icl/css/general.min.css?ver=1761724536" media="all" />
  <link rel="stylesheet" href="https://bra.icl-group.com/wp-content/themes/icl/css/new-styles.min.css?ver=1761724536" media="all" />
  <style>
    body { background: #f6fafd; margin: 0; font-family: 'Inter', 'Demo', sans-serif; }
    .main-container { max-width: 1100px; margin: 40px auto 0 auto; background: #fff; border-radius: 18px; box-shadow: 0 4px 24px rgba(0,0,0,.05); padding: 36px 32px 32px 32px; }
    .usuarios-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; }
    .usuarios-header h1 { font-size: 2.1rem; color: #002846; font-weight: 400; margin: 0; }
    .btn-novo { background: #00B5D3; color: #fff; border: none; border-radius: 8px; padding: 10px 24px; font-size: 15px; font-family: inherit; cursor: pointer; transition: background .2s; display: flex; align-items: center; gap: 7px; }
    .btn-novo:hover { background: #0090a8; }
    .usuarios-table { width: 100%; border-collapse: collapse; background: #f6fafd; border-radius: 12px; overflow: hidden; }
    .usuarios-table th, .usuarios-table td { padding: 13px 12px; text-align: left; font-size: 15px; }
    .usuarios-table th { background: #e6f6fa; color: #00B5D3; font-weight: 600; }
    .usuarios-table tr:not(:last-child) { border-bottom: 1px solid #e6e6e6; }
    .usuarios-table td.status-ativo { color: #61CE70; font-weight: 500; }
    .usuarios-table td.status-inativo { color: #cf2e2e; font-weight: 500; }
    .usuarios-table td .btn-acao { background: none; border: none; color: #00B5D3; cursor: pointer; font-size: 16px; margin-right: 10px; transition: color .2s; }
    .usuarios-table td .btn-acao:last-child { margin-right: 0; }
    .usuarios-table td .btn-acao:hover { color: #002846; }
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.23); z-index: 1000; align-items: center; justify-content: center; }
    .modal-overlay.active { display: flex; }
    .modal { background: #fff; border-radius: 16px; max-width: 420px; width: 96vw; padding: 32px 28px 24px 28px; box-shadow: 0 8px 32px rgba(0,0,0,.13); position: relative; }
    .modal h2 { font-size: 1.3rem; color: #00B5D3; margin-bottom: 18px; }
    .modal form label { display: block; font-size: 15px; color: #002846; margin-bottom: 3px; font-weight: 500; }
    .modal form input, .modal form select { width: 100%; border: 1px solid #cce2e8; border-radius: 8px; padding: 7px 10px; font-size: 15px; margin-bottom: 13px; background: #f6fafd; color: #002846; }
    .modal .modal-actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 10px; }
    .modal .btn-cancelar { background: none; border: none; color: #cf2e2e; font-size: 15px; cursor: pointer; }
    .modal .btn-salvar { background: #00B5D3; color: #fff; border: none; border-radius: 8px; padding: 8px 20px; font-size: 15px; cursor: pointer; }
    .modal .btn-salvar:hover { background: #0090a8; }
    .modal .close-modal { position: absolute; top: 10px; right: 18px; background: none; border: none; font-size: 22px; color: #888; cursor: pointer; }
    .log-section { margin-top: 38px; background: #f6fafd; border-radius: 12px; padding: 18px 18px 8px 18px; }
    .log-section h2 { font-size: 1.1rem; color: #00B5D3; margin-bottom: 10px; }
    .log-table { width: 100%; border-collapse: collapse; font-size: 14px; }
    .log-table th, .log-table td { padding: 7px 8px; text-align: left; }
    .log-table th { background: #e6f6fa; color: #00B5D3; font-weight: 600; }
    .log-table tr:not(:last-child) { border-bottom: 1px solid #e6e6e6; }
    @media (max-width: 900px) {
      .main-container { padding: 18px 4vw; }
      .usuarios-header { flex-direction: column; align-items: flex-start; gap: 14px; }
    }
  </style>
</head>
<body>
  <!-- Header reutiliz치vel -->
  <div id="header-placeholder"></div>
  <main class="main-container">
    <div class="usuarios-header">
      <h1>Gest칚o de Usu치rios</h1>
      <button class="btn-novo" onclick="abrirModalNovoUsuario()">
        <svg width="18" height="18" fill="none" viewBox="0 0 24 24"><path d="M12 5v14m-7-7h14" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
        Novo Usu치rio
      </button>
    </div>
    <div style="overflow-x:auto;">
      <table class="usuarios-table" aria-label="Tabela de usu치rios">
        <thead>
          <tr>
            <th>Nome</th>
            <th>E-mail</th>
            <th>Perfil</th>
            <th>Status</th>
            <th>A칞칫es</th>
          </tr>
        </thead>
        <tbody id="usuariosBody">
          <!-- Usu치rios mockados -->
        </tbody>
      </table>
    </div>
    <!-- Modal de novo/editar usu치rio -->
    <div class="modal-overlay" id="modalUsuario">
      <div class="modal" role="dialog" aria-modal="true">
        <button class="close-modal" onclick="fecharModalUsuario()" aria-label="Fechar">&times;</button>
        <h2 id="modalTitulo">Novo Usu치rio</h2>
        <form id="formUsuario" onsubmit="salvarUsuario(event)">
          <label for="nome">Nome</label>
          <input type="text" id="nome" name="nome" required />
          <label for="email">E-mail</label>
          <input type="email" id="email" name="email" required />
          <label for="perfil">Perfil</label>
          <select id="perfil" name="perfil" required>
            <option value="Administrador ICL">Administrador ICL</option>
            <option value="Operador ICL">Operador ICL</option>
            <option value="Fornecedor">Fornecedor</option>
            <option value="Transportadora">Transportadora</option>
          </select>
          <label for="status">Status</label>
          <select id="status" name="status" required>
            <option value="ativo">Ativo</option>
            <option value="inativo">Inativo</option>
          </select>
          <div class="modal-actions">
            <button type="button" class="btn-cancelar" onclick="fecharModalUsuario()">Cancelar</button>
            <button type="submit" class="btn-salvar">Salvar</button>
          </div>
        </form>
      </div>
    </div>
    <!-- Log de auditoria -->
    <section class="log-section">
      <h2>Log de Auditoria</h2>
      <table class="log-table" aria-label="Log de auditoria">
        <thead>
          <tr>
            <th>Data/Hora</th>
            <th>Usu치rio</th>
            <th>A칞칚o</th>
            <th>Detalhes</th>
          </tr>
        </thead>
        <tbody id="logBody">
          <!-- Logs mockados -->
        </tbody>
      </table>
    </section>
  </main>
  <script>
    // Header din칙mico reutiliz치vel
    fetch('/prototipos/components/header.html').then(res => res.text()).then(html => {
      document.getElementById('header-placeholder').innerHTML = html;
    });
    // Mock de usu치rios
    let usuarios = [
      { nome: 'Ana Souza', email: 'ana@icl.com', perfil: 'Administrador ICL', status: 'ativo' },
      { nome: 'Carlos Lima', email: 'carlos@icl.com', perfil: 'Operador ICL', status: 'ativo' },
      { nome: 'Fornecedor XPTO', email: 'contato@fornecedorxpto.com', perfil: 'Fornecedor', status: 'ativo' },
      { nome: 'Transp. Alfa', email: 'alfa@transportes.com', perfil: 'Transportadora', status: 'inativo' }
    ];
    let editIndex = null;
    function renderUsuarios() {
      const tbody = document.getElementById('usuariosBody');
      tbody.innerHTML = '';
      usuarios.forEach((u, i) => {
        tbody.innerHTML += `<tr>
          <td>${u.nome}</td>
          <td>${u.email}</td>
          <td>${u.perfil}</td>
          <td class="status-${u.status}">${u.status.charAt(0).toUpperCase() + u.status.slice(1)}</td>
          <td>
            <button class="btn-acao" title="Editar" onclick="editarUsuario(${i})">九勇</button>
            <button class="btn-acao" title="Desativar" onclick="desativarUsuario(${i})">游뛂</button>
          </td>
        </tr>`;
      });
    }
    renderUsuarios();
    function abrirModalNovoUsuario() {
      editIndex = null;
      document.getElementById('modalTitulo').textContent = 'Novo Usu치rio';
      document.getElementById('formUsuario').reset();
      document.getElementById('modalUsuario').classList.add('active');
    }
    function editarUsuario(i) {
      editIndex = i;
      const u = usuarios[i];
      document.getElementById('modalTitulo').textContent = 'Editar Usu치rio';
      document.getElementById('nome').value = u.nome;
      document.getElementById('email').value = u.email;
      document.getElementById('perfil').value = u.perfil;
      document.getElementById('status').value = u.status;
      document.getElementById('modalUsuario').classList.add('active');
    }
    function desativarUsuario(i) {
      if (confirm('Deseja desativar este usu치rio?')) {
        usuarios[i].status = 'inativo';
        renderUsuarios();
        adicionarLog('Desativa칞칚o', usuarios[i].nome, 'Usu치rio desativado');
      }
    }
    function fecharModalUsuario() {
      document.getElementById('modalUsuario').classList.remove('active');
    }
    function salvarUsuario(e) {
      e.preventDefault();
      const nome = document.getElementById('nome').value;
      const email = document.getElementById('email').value;
      const perfil = document.getElementById('perfil').value;
      const status = document.getElementById('status').value;
      if (editIndex !== null) {
        usuarios[editIndex] = { nome, email, perfil, status };
        adicionarLog('Edi칞칚o', nome, 'Usu치rio editado');
      } else {
        usuarios.push({ nome, email, perfil, status });
        adicionarLog('Cria칞칚o', nome, 'Novo usu치rio cadastrado');
      }
      renderUsuarios();
      fecharModalUsuario();
    }
    // Log de auditoria mock
    let logs = [
      { data: '2024-06-01 10:12', usuario: 'Ana Souza', acao: 'Login', detalhes: 'Acesso ao sistema' },
      { data: '2024-06-01 10:15', usuario: 'Carlos Lima', acao: 'Cria칞칚o', detalhes: 'Novo usu치rio cadastrado: Fornecedor XPTO' },
      { data: '2024-06-01 10:18', usuario: 'Ana Souza', acao: 'Desativa칞칚o', detalhes: 'Usu치rio desativado: Transp. Alfa' }
    ];
    function renderLogs() {
      const tbody = document.getElementById('logBody');
      tbody.innerHTML = '';
      logs.forEach(l => {
        tbody.innerHTML += `<tr>
          <td>${l.data}</td>
          <td>${l.usuario}</td>
          <td>${l.acao}</td>
          <td>${l.detalhes}</td>
        </tr>`;
      });
    }
    renderLogs();
    function adicionarLog(acao, usuario, detalhes) {
      const now = new Date();
      const data = now.toLocaleString('pt-BR', { hour12: false });
      logs.unshift({ data, usuario, acao, detalhes });
      renderLogs();
    }
    // Fechar modal ao clicar fora
    document.getElementById('modalUsuario').addEventListener('click', function(e) {
      if (e.target === this) fecharModalUsuario();
    });
  </script>
</body>
</html>